---
layout: default
title: Fiji-OMERO Workflows
menu-id: l1-workflow2
pdfs:
    - workflows-fiji.pdf
description: How to use Fiji to connect to an OMERO server and run scripts against data on the server.
version:
    - yes
---

<div class="page-navigation">
<h2>Contents</h2>
<p>
<a href="#setup">Setup</a><br />
<a href="#manual">Manual Workflow</a><br />
<a href="#script">Scriping Worksflow</a><br />
</p>

</div><!-- End Page Navigation -->

<h2><a class="anchor" id="setup"></a>Setup</h2>

<p>Instructions on downloading and installing the OMERO.insight-ij plugin for Fiji and ImageJ are in the <a href="http://help.openmicroscopy.org/imagej.html" target="_blank" class="external-url">Using ImageJ with OMERO</a> section.

<h2><a class="anchor" id="manual"></a>Manual Workflow</h2>

<ol>

<li><p class="first">Open the Fiji application.</p>

<p>Select <span class="bold">Plugins > OMERO > Connect to OMERO</span>.</p>

<p>A version of OMERO.insight will open and can be used as normal.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/imagejInsightLaunch.jpg" class="align-center" src="images/imagejInsightLaunch.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first">As ImageJ needs to load the plugin software, it can take a minute or two for the OMERO login screen to appear, and then another minute for the progress bar to start moving and complete.</p>

<p>If you have not previously connected to OMERO, enter the server address.</p>

<p>Enter your OMERO Username and Password.</p>

<p>Click <span class="bold">Login</span>.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/imagejLogin.jpg" class="align-center" src="images/imagejLogin.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first">In the OMERO.insight window, select the image you wish to work with.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsFijiImage.jpg" class="align-center" src="images/workflowsFijiImage.jpg" style="width: 80%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first">Right-click on the image and select <span class="bold">View in ImageJ...</span>.</p>

<p>In the Bio-Formats Import Options dialog, click <span class="bold">OK</span>.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsFijiView.jpg" class="align-center" src="images/workflowsFijiView.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first">In Fiji, select <span class="bold">Image > Adjust > Threshold</span>.</p>

<p>Click on the <span class="bold">Auto</span> button, which should bring up the default for the image.</p>

<p>If necessary use the sliders adjust the threshold values to obtain the desired thresholding.</p>

<p>Select the <span class="bold">Dark Background</span> checkbox.</p>

<p>Click <span class="bold">Apply</span> and close the dialog.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsFijiThreshold.jpg" class="align-center" src="images/workflowsFijiThreshold.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>


<li><p class="first">Select <span class="bold">Analyze > Analyze Particles</span>.</p>

<p>In the Analyze Particles dialog, check the values are as shown below, ensuring the <span class="bold">Display Results</span>, <span class="bold">Clear Results</span> and <span class="bold">Add to Manager</span> checkboxes are selected.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsFijiAnalyze.jpg" class="align-center" src="images/workflowsFijiAnalyze.jpg" style="width: 80%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first">The following dialogs should be visible:</p>

<ul>
<li>the image with ROIs highlighted</li>
<li>Results table</li>
<li>ROI Manager</li>
</ul>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsFijiROIs.jpg" class="align-center" src="images/workflowsFijiROIs.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first">In Fiji, select <span class="bold">Plugins > OMERO > Save Results to OMERO</span>.</p>

<p>Note: If you are not logged into the OMERO server you will be prompted to log in.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsFijiSave.jpg" class="align-center" src="images/workflowsFijiSave.jpg" style="width: 80%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first">In the <span class="bold">Save ImageJ Results</span> dialog select the <span class="bold">Image from Current Window</span> radio button.</p>

<p>Check the <span class="bold">ROI and Measurements</span> checkboxes.</p>

<p>Click <span class="bold">Save</span>.</p>

<p>Click <span class="bold">Yes</span> in the <span class="bold">Import Images</span> dialog.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsFijiYes.jpg" class="align-center" src="images/workflowsFijiYes.jpg" style="width: 80%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first">In the <span class="bold">Import Location</span> dialog, select the <span class="bold">Project</span> and/or <span class="bold">Dataset</span> from the drop-downs to save the results to.</p>

<p> <span class="bold"></span>.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsFijiQueue.jpg" class="align-center" src="images/workflowsFijiQueue.jpg" style="width: 95%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first">Once the import is completed, the OMERO server takes a little time to generate the ROIs in OMERO form.</p>

<p>Once the ROI generation process is complete, select the imported image to show the ROIs attached.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsFijiRHP.jpg" class="align-center" src="images/workflowsFijiRHP.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

</ol><!-- End of list -->

<p class="top_link"><a href="#top"><img src="images/back_to_top.png" alt="Image for link to top of page" style="float: right;"/></a></p>

<div class="line-block">
  <div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<h2><a class="anchor" id="script"></a>Scripting workflow</h2>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<h3>Additional setup</h3>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<ol>

<li><p class="first">Download the OMERO.matlab plugin from:</p>

<p><a href="http://downloads.openmicroscopy.org/latest/omero5" target="_blank" class="external-url">http://downloads.openmicroscopy.org/latest-develop/bio-formats</a></p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsMatlab.jpg" class="align-center" src="images/workflowsMatlab.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first">Unzip the archive.</p>

<p>Drag-and-drop or copy the <span class="code-example">libs > omero_client.jar</span> file into the jars folder of Fiji .</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsMatlabPlugin.jpg" class="align-center" src="images/workflowsMatlabPlugin.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first">Download the example script and related files from:</p>

<p><a href="https://github.com/bramalingam/Omero-Imagej-Scripts" target="_blank" class="external-url">https://github.com/bramalingam/Omero-Imagej-Scripts</a></p>

<p>Links to individual files:</p>

<p><a href="https://github.com/bramalingam/Omero-Imagej-Scripts/blob/master/credentialsTemplate.txt" target="_blank" class="external-url">https://github.com/bramalingam/Omero-Imagej-Scripts/blob/master/credentialsTemplate.txt</a></p>

<p><a href="https://github.com/bramalingam/Omero-Imagej-Scripts" target="_blank" class="external-url">https://github.com/bramalingam/Omero-Imagej-Scripts</a></p>

<p><a href="https://github.com/bramalingam/Omero-Imagej-Scripts/blob/master/omero_batch_analysis.py" target="_blank" class="external-url">https://github.com/bramalingam/Omero-Imagej-Scripts/blob/master/omero_batch_analysis.py</a></p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsMatlab.jpg" class="align-center" src="images/workflowsMatlab.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first"> <span class="bold"></span>.</p>

<p> <span class="bold"></span>.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/xxx.jpg" class="align-center" src="images/xxx.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first"> <span class="bold"></span>.</p>

<p> <span class="bold"></span>.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/xxx.jpg" class="align-center" src="images/xxx.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

</ol><!-- End of list -->



Editing scripts

1	Open Fiji.
Open the  omero_batch_analysis.py  file.
File > Open > select file.
This will open the jython script in the script window.


.. image:: /images/workflowsScript.jpg

2	Edit the following:

Line 131:
From:	HOST = ìomero-latest-analysis.docker.openmicroscopy.org
To:	HOST = ìyour.omero.server.urlî

Line 133:	
From:	datasetId = ì1î
To:		datasetId= ìxî

Where ìxî is an OMERO Dataset ID of your choice.

Line 139:
From:	CREDENTIALS = ì/Users/bramalingam/Desktop/FijiDemonstration/credentials.txtî
To:		CREDENTIALS = ìPATH_TO/credentials.txtî

Line 142:	
From:	macroFilePath = ì/Users/bramalingam/Desktop/FijiDemonstration/bg_subtract.ijmî
To:		macroFilePath = ìPATH_TO/bg_subtract.ijmî

Line 145:	
From:	paths = ìUsers/bramalingam/Desktop/FijiDemonstrationî
To:		paths = ìPATH_TOî

Where ìPATH_TOî is the file path on your system to the files you downloaded previously.

3	Save the script file.
File > Save.

4	Open the  credentialsTemplate.txt  file.
File > Open > select file.

5	Enter the following using the OMERO login credentials you have been given:

Line 1:
From:	USERNAME = <OMERO USERNAME>
To:	USERNAME = <user-x>

Line 2:
From:	PASSWORD = <OMERO PASSWORD>
To:	PASSWORD = <ome>

6	Save the credentials file as  credentials.txt  in the same directory.
File > Save As > Text... .

7	Click the Run button to run the script.

.. image:: /images/workflowsRun.jpg

8	Once the script is completed, use OMERO to check the processed images which should be found in the dataset with the ID used in Step 2, Line 133.
Repeat Steps 5 - 7.

9	To run the same macro on a different set of Images, in Step 2 Line 133, enter a different Dataset ID number.
Repeat Steps 5 - 7.

10	To run a different macro on the same set of Images, in Step 2 Line 142, enter a different .ijm  file name.
Repeat Steps 5 - 7.



Other resources

Videos of these workflows:

 HYPERLINK "http://downloads.openmicroscopy.org/movies/omero-5-2/mov/fiji_omero_manual_workflow.mov" fiji_omero_manual_workflow.mov

 HYPERLINK "http://downloads.openmicroscopy.org/movies/omero-5-2/mov/fiji_scripting_demo.mov" fiji_scripting_demo.mov

(http://downloads.openmicroscopy.org/movies/omero-5-2/mov/fiji_omero_manual_workflow.mov)
(http://downloads.openmicroscopy.org/movies/omero-5-2/mov/fiji_scripting_demo.mov)



FIJI Scripting Tutorial:

HYPERLINK "http://imagej.net/Jython_Scripting" http://imagej.net/Jython_Scripting

HYPERLINK "https://www.ini.uzh.ch/%7Eacardona/fiji-tutorial/" https://www.ini.uzh.ch/~acardona/fiji-tutorial/



 



<p class="top_link"><a href="#top"><img src="images/back_to_top.png" alt="Image for link to top of page" style="float: right;"/></a></p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<div class="page-end">
	<p>All Tutorial Material is available on line at: <a href="http://help.openmicroscopy.org">help.openmicroscopy.org</a></p>
	<p>The Main OME website is at: <a href="http://www.openmicroscopy.org">www.openmicroscopy.org</a></p>
</div> <!-- end page-end -->
