---
layout: default
title: OMERO.mtools Workflow
menu-id: l1-workflow2
pdfs:
    - workflows-mtools.pdf
description: How to use OMERO.mtools to perform common image analysis tasks on images stored in an OMERO server.
version:
    - yes
---

<div class="page-navigation">
<h2>Contents</h2>
<p>
<a href="#introduction">Introduction</a><br />
<a href="#setup">Setup</a><br />
<a href="#boxit">Box It</a><br />
<a href="#intensity">Intensity Measure</a><br />
</p>

</div><!-- End Page Navigation -->

<h2><a class="anchor" id="introduction"></a>Introduction</h2>

<p>This is a step-by-step guide to the workflows used in OMERO training sessions and the videos produced to illustrate the basic Fiji-OMERO image analysis workflows. Links to the videos are in the <a href="#resources">Other resources</a> section at the bottom of the page.</p>

<p>Instructions on downloading and installing the OMERO.insight-ij plugin for Fiji and ImageJ are in the <a href="http://help.openmicroscopy.org/imagej.html" target="_blank" class="external-url">Using ImageJ with OMERO</a> section.


<h2><a class="anchor" id="setup"></a>Setup</h2>

<ol>

<li><p class="first">Download the appropriate OMERO.mtools for your operating system from:</p>

<a href="http://downloads.openmicroscopy.org/latest/omero5" target="_blank" class="external-url">http://downloads.openmicroscopy.org/mtools/1.2.0/</a>

<p>If you are using Windows, it is recommended to also download the MCR for Windows.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsMtoolsDownload.jpg" class="align-center" src="images/workflowsMtoolsDownload.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first">Install OMERO.mtools and MCR if you do not have a Matlab installation.</p>

<h3>Windows:</h3>

<p>It is recommended that you download the MCR from the downloads page above, and install it before running the OMERO.mtools installer to speed up the installation.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsMtoolsMCRInstall.jpg" class="align-center" src="images/workflowsMtoolsMCRInstall.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<div class="note">
<p class="note-title">Note</p>
<p class="note-text">The OMERO.mtools installer will automatically download the Matlab Compiler Runtime (MCR) from Mathworks and install it, but slow server speeds makes this painful, hence the recommendation to install it separately first.</p>
</div><!-- End note -->

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<p>Unzip the OMERO.mtools download and double-click on it, and follow the prompts to install.</p>

<p>Click <span class="bold">Login</span>.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsMtoolsInstallWindows.jpg" class="align-center" src="images/workflowsMtoolsInstallWindows.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<p class="top_link"><a href="#top"><img src="images/back_to_top.png" alt="Image for link to top of page" style="float: right;"/></a></p>

<h3>Mac OSX:</h3>

<li><p class="first">Enter your OMERO <span class="bold">User name</span>, <span class="bold">Password</span> and <span class="bold">Server</span> name.</p>

<p>Click on the appropriate button to select the desired function.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsMtoolsCredentials.jpg" class="align-center" src="images/workflowsMtoolsCredentials.jpg" style="width: 80%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<p>Following are illustrations of two of the functionalities covered by OMERO.mtools.</p>

</ol>

<h2><a class="anchor" id="boxit"></a>Box It</h2>

<p>Box It draws ROIs around structures through all of the planes in the Z-stack for use in subsequent analysis.</p>

<div class="note">
<p class="note-title">Note</p>
<p class="note-text">Images have to be organized in the Project-Dataset hierarchy to be accessed via OMERO.mtools. Datasets not in a Project or orphaned Images cannot be accessed via OMERO.mtools.</p>
</div><!-- End note -->

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<ol>

<li><p class="first">Click on the <span class="bold">Box It</span> button to start.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsMtoolsBoxIt.jpg" class="align-center" src="images/workflowsMtoolsBoxIt.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<p class="top_link"><a href="#top"><img src="images/back_to_top.png" alt="Image for link to top of page" style="float: right;"/></a></p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<li><p class="first">Select the OMERO group you wish to access data from.</p>

<p>Click <span class="bold">OK</span>.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsMtoolsOpenImage.jpg" class="align-center" src="images/workflowsMtoolsOpenImage.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>


<li><p class="first">From the drop-down menus in the Image Chooser, select the project, dataset and image you wish to open.</p>

<p>Click <span class="bold">OK</span>.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsMtoolsOpenImage.jpg" class="align-center" src="images/workflowsMtoolsOpenImage.jpg" style="width: 80%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<p class="top_link"><a href="#top"><img src="images/back_to_top.png" alt="Image for link to top of page" style="float: right;"/></a></p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<li><p class="first">Click on the <span class="bold">ROI drawing tool</span> to draw an ROI around a structure.</p>

<p>The first ROI drawn triggers the download of the data, which may take a minute or two.</p>

<p>The dotted line should be drawn generously round the structure as it will resize automatically to minimally fit the structure.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsMtoolsDrawROI.jpg" class="align-center" src="images/workflowsMtoolsDrawROI.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first">Click on the <span class="bold">Selection tool</span> to select an ROI, the selected ROI is green.</p>

<p>If necessary, an ROI can be deleted by selecting it and clicking the <span class="bold">Delete</span> button.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsMtoolsSelectROI.jpg" class="align-center" src="images/workflowsMtoolsSelectROI.jpg" style="width: 80%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<p class="top_link"><a href="#top"><img src="images/back_to_top.png" alt="Image for link to top of page" style="float: right;"/></a></p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<li><p class="first">Select <span class="bold">File > Save ROIs</span> to save the ROIs to the OMERO server.</p>

<p>Use the <span class="bold">Next Image</span> and <span class="bold">Previous Image</span> buttons to move to the other images in the dataset and repeat Step 5 to draw ROIs on other images in the Dataset.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsFijiYes.jpg" class="align-center" src="images/workflowsFijiYes.jpg" style="width: 80%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<p class="top_link"><a href="#top"><img src="images/back_to_top.png" alt="Image for link to top of page" style="float: right;"/></a></p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<li><p class="first">In the <span class="bold">Import Location</span> dialog, select the <span class="bold">Project</span> and/or <span class="bold">Dataset</span> from the drop-downs to save the results to.</p>

<p>Click <span class="bold">Add to the Queue</span>.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsFijiQueue.jpg" class="align-center" src="images/workflowsFijiQueue.jpg" style="width: 95%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first">Once the import is completed, the OMERO server takes a little time to generate the ROIs in OMERO form.</p>

<p>Once the ROI generation process is complete, select the imported image to show the ROIs attached.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsFijiRHP.jpg" class="align-center" src="images/workflowsFijiRHP.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

</ol><!-- End of list -->

<p class="top_link"><a href="#top"><img src="images/back_to_top.png" alt="Image for link to top of page" style="float: right;"/></a></p>

<div class="line-block">
  <div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<h2><a class="anchor" id="script"></a>Scripting workflow</h2>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<h3>Additional setup</h3>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<ol>

<li><p class="first">Download the <span class="code-example">OMERO.matlab</span> plugin from:</p>

<p><a href="http://downloads.openmicroscopy.org/latest/omero5" target="_blank" class="external-url">http://downloads.openmicroscopy.org/latest/omero5</a></p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsFijiMatlab.jpg" class="align-center" src="images/workflowsFijiMatlab.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<p class="top_link"><a href="#top"><img src="images/back_to_top.png" alt="Image for link to top of page" style="float: right;"/></a></p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<li><p class="first">Unzip the archive.</p>

<p>Drag-and-drop or copy the <span class="code-example">libs > omero_client.jar</span> file into the jars folder of Fiji .</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsFijiMatlabPlugin.jpg" class="align-center" src="images/workflowsFijiMatlabPlugin.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first">Download the example script and related files from:</p>

<p><a href="https://github.com/bramalingam/Omero-Imagej-Scripts" target="_blank" class="external-url">https://github.com/bramalingam/Omero-Imagej-Scripts</a></p>

<p>Links to individual files:</p>

<p><a href="https://github.com/bramalingam/Omero-Imagej-Scripts/blob/master/bg_subtract.ijm" target="_blank" class="external-url">bg_subtract.ijm</a></p>

<p><a href="https://github.com/bramalingam/Omero-Imagej-Scripts/blob/master/credentialsTemplate.txt" target="_blank" class="external-url">credentialsTemplate.txt</a></p>

<p><a href="https://github.com/bramalingam/Omero-Imagej-Scripts/blob/master/omero_batch_analysis.py" target="_blank" class="external-url">omero_batch_analysis.py</a></p>

</li>

</ol>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->
<h3>Editing scripts</h3>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<ol>

<li><p class="first">Open Fiji.</p>

<p>Use <span class="bold">File &#62; Open...</span> to select and open the <span class="code-example">omero_batch_analysis.py</span> file.</p>

<p>The jython script will open in the script window.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsFijiScript.jpg" class="align-center" src="images/workflowsFijiScript.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<p class="top_link"><a href="#top"><img src="images/back_to_top.png" alt="Image for link to top of page" style="float: right;"/></a></p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<li><p class="first">Edit the following:</p>

<p><span class="bold">Line 131:</span><br/>
From:&nbsp;&nbsp;&nbsp;<span class="code-example">HOST = &#34;omero-latest-analysis.docker.openmicroscopy.org&#34;</span><br/>
To:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-example">HOST = &#34;your.omero.server.url&#34;</span></p>

<p><span class="bold">Line 133:</span><br/>
From:&nbsp;&nbsp;&nbsp;<span class="code-example">datasetId = &#34;1&#34;</span><br/>
To:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-example">datasetId = &#34;x&#34;</span></p>

<p>Where <span class="code-example">&#34;x&#34;</span> is an OMERO Dataset ID of your choice.</p>

<p><span class="bold">Line 139:</span><br/>
From:&nbsp;&nbsp;&nbsp;<span class="code-example">CREDENTIALS = &#34;/Users/bramalingam/Desktop/FijiDemonstration/credentials.txt&#34;</span><br/>
To:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-example">CREDENTIALS = &#34;PATH_TO/credentials.txt&#34;</span></p>

<p><span class="bold">Line 142:</span><br/>
From:&nbsp;&nbsp;&nbsp;<span class="code-example">macroFilePath = &#34;/Users/bramalingam/Desktop/FijiDemonstration/bg_subtract.ijm&#34;</span><br/>
To:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-example">macroFilePath = &#34;PATH_TO/bg_subtract.ijm&#34;</span></p>

<p><span class="bold">Line 145:</span><br/>
From:&nbsp;&nbsp;&nbsp;<span class="code-example">paths = &#34;Users/bramalingam/Desktop/FijiDemonstration&#34;</span><br/>
To:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-example">paths = &#34;PATH_TO&#34;</span></p>

<p>Where <span class="code-example">&#34;PATH_TO&#34;</span> is the file path on your system to the files you downloaded previously.</p>

</li>

<li><p class="first">Use <span class="bold">File &#62; Save</span> to save the script file.</p>

</li>

<li><p class="first">Use <span class="bold">File &#62; Open...</span> to select and open the <span class="code-example">credentialsTemplate.txt</span> file.</p>

</li>

<li><p class="first">Enter the following using the OMERO login credentials you have been given:</p>

<p><span class="bold">Line 1:</span></span><br/>
From:&nbsp;&nbsp;&nbsp;<span class="code-example">USERNAME = &#60;OMERO USERNAME&#62;</span><br/>
To:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-example">USERNAME = &#60;your_username&#62;</span></p>

<p><span class="bold">Line 2:</span><br/>
From:&nbsp;&nbsp;&nbsp;<span class="code-example">PASSWORD = &#60;OMERO PASSWORD&#62;</span><br/>
To:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="code-example">PASSWORD = &#60;your_password&#62;</span></p>

</li>

<li><p class="first">Use <span class="bold">File &#62; Save As &#62; Text...</span> to save the credentials file as <span class="code-example">credentials.txt</span> in the same directory.</p>

</li>

<p class="top_link"><a href="#top"><img src="images/back_to_top.png" alt="Image for link to top of page" style="float: right;"/></a></p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<li><p class="first">Click the <span class="bold">Run</span> button to run the script.</p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<img alt="../images/workflowsFijiRun.jpg" class="align-center" src="images/workflowsFijiRun.jpg" style="width: 100%;" />

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

</li>

<li><p class="first">Once the script is completed, use OMERO to check the processed images which should be found in the dataset with the ID used in Step 2, Line 133.</p>

<p>Repeat Steps 5 - 7.</p>

</li>

<li><p class="first">To run the same macro on a different set of Images, in Step 2 Line 133, enter a different Dataset ID number.</p>

<p>Repeat Steps 5 - 7.</p>

</li>

<li><p class="first">To run a different macro on the same set of Images, in Step 2 Line 142, enter a different <span class="code-example">.ijm</span> file name.</p>

<p>Repeat Steps 5 - 7.</p>

</li>

</ol><!-- End of list -->

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<h2><a class="anchor" id="resources"></a>Other resources</h2>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<h3>Videos of these workflows:</h3>

<p><a href="http://downloads.openmicroscopy.org/movies/omero-5-2/mov/fiji_omero_manual_workflow.mov" target="_blank" class="external-url">fiji_omero_manual_workflow.mov</a></p>


<p><a href="http://downloads.openmicroscopy.org/movies/omero-5-2/mov/fiji_scripting_demo.mov" target="_blank" class="external-url">fiji_scripting_demo.mov</a></p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<h3>FIJI scripting tutorials:</h3>

<p><a href="http://imagej.net/Jython_Scripting" target="_blank" class="external-url">http://imagej.net/Jython_Scripting</a></p>

<p><a href="https://www.ini.uzh.ch/%7Eacardona/fiji-tutorial/" target="_blank" class="external-url">https://www.ini.uzh.ch/&#126;cardona/fiji-tutorial/</a></p>

<p class="top_link"><a href="#top"><img src="images/back_to_top.png" alt="Image for link to top of page" style="float: right;"/></a></p>

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<div class="line-block">
<div class="line"><br /></div> <!-- end #line -->
</div> <!-- end #line-block -->

<div class="page-end">
	<p>All Tutorial Material is available on line at: <a href="http://help.openmicroscopy.org">help.openmicroscopy.org</a></p>
	<p>The Main OME website is at: <a href="http://www.openmicroscopy.org">www.openmicroscopy.org</a></p>
</div> <!-- end page-end -->
